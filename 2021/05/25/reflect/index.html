<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>reflect | 北冥の鱼</title><meta name="keywords" content="Java系列,反射"><meta name="author" content="月月鸟"><meta name="copyright" content="月月鸟"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="该思维导图的在线链接：https:&#x2F;&#x2F;share.mubu.com&#x2F;doc&#x2F;7GrYLgtlw9X 反射为何物Java反射机制在程序运行时，对于任何一个类，都能知道这个类的所有属性和方法；对于任何一个对象，都能调用它的任何一个方法和属性。这种动态获取信息以及动态调用对象的功能称为Java反射机制。 为了更好地理解反射，我们不妨看下Oracle官方文档  Reflection is commonl">
<meta property="og:type" content="article">
<meta property="og:title" content="reflect">
<meta property="og:url" content="https://yueyueniao0223.me/2021/05/25/reflect/index.html">
<meta property="og:site_name" content="北冥の鱼">
<meta property="og:description" content="该思维导图的在线链接：https:&#x2F;&#x2F;share.mubu.com&#x2F;doc&#x2F;7GrYLgtlw9X 反射为何物Java反射机制在程序运行时，对于任何一个类，都能知道这个类的所有属性和方法；对于任何一个对象，都能调用它的任何一个方法和属性。这种动态获取信息以及动态调用对象的功能称为Java反射机制。 为了更好地理解反射，我们不妨看下Oracle官方文档  Reflection is commonl">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2.1/images/image-20210525002237262.png">
<meta property="article:published_time" content="2021-05-24T16:33:01.000Z">
<meta property="article:modified_time" content="2021-05-24T16:50:50.765Z">
<meta property="article:author" content="月月鸟">
<meta property="article:tag" content="Java系列">
<meta property="article:tag" content="反射">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2.1/images/image-20210525002237262.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yueyueniao0223.me/2021/05/25/reflect/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-05-25 00:50:50'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.3.0"><link rel="alternate" href="/rss2.xml" title="北冥の鱼" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2.1/images/image-20210525002237262.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">北冥の鱼</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">reflect</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-05-24T16:33:01.000Z" title="发表于 2021-05-25 00:33:01">2021-05-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-05-24T16:50:50.765Z" title="更新于 2021-05-25 00:50:50">2021-05-25</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>7分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src="https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2.1/images/image-20210525002237262.png"/></p>
<p>该思维导图的在线链接：<a target="_blank" rel="noopener" href="https://share.mubu.com/doc/7GrYLgtlw9X">https://share.mubu.com/doc/7GrYLgtlw9X</a></p>
<h3 id="反射为何物"><a href="#反射为何物" class="headerlink" title="反射为何物"></a>反射为何物</h3><p>Java反射机制在程序运行时，对于任何一个类，都能知道这个类的所有属性和方法；对于任何一个对象，都能调用它的任何一个方法和属性。这种<strong>动态获取信息</strong>以及<strong>动态调用对象</strong>的功能称为Java反射机制。</p>
<p>为了更好地理解反射，我们不妨看下Oracle官方文档</p>
<blockquote>
<p><strong>Reflection</strong> is commonly used by programs which require the ability to examine or modify the <strong>runtime behavior</strong> of applications running in the Java virtual machine. This is a relatively advanced feature and should be used only by developers who have a strong grasp of the fundamentals of the language. With that caveat in mind, reflection is a powerful technique and can enable applications to perform operations which would otherwise be impossible.</p>
</blockquote>
<p>反射一般用于检查或修改程序在JVM运行时的行为。如果我们知道了反射，并且了解了其原理，那么我们便可完成一些不可能的事情。正因为其如此强大，因此反射不可滥用！</p>
<h3 id="反射有何用"><a href="#反射有何用" class="headerlink" title="反射有何用"></a>反射有何用</h3><p>依旧是官方文档，反射的作用主要有以下三点~</p>
<blockquote>
<p><strong>Extensibility Features</strong></p>
<p>An application may make use of external, user-defined classes by creating instances of extensibility objects using their fully-qualified names.</p>
<p><strong>Class Browsers and Visual Development Environments</strong></p>
<p>A class browser needs to be able to enumerate the members of classes. Visual development environments can benefit from making use of type information available in reflection to aid the developer in writing correct code.</p>
<p><strong>Debuggers and Test Tools</strong></p>
<p>Debuggers need to be able to examine private members on classes. Test harnesses can make use of reflection to systematically call a discoverable set APIs defined on a class, to insure a high level of code coverage in a test suite.</p>
</blockquote>
<p>1.可以通过外部类的全限定名来创建对象，并使用这些对象来完成一些扩展功能</p>
<p>2.可以枚举类的所有成员，包括方法、变量、构造函数。可视化的环境有益于让开发者写出正确的代码。</p>
<p>3.可以更好地提高测试覆盖率，通过反射，测试工具可以系统地调用在类上定义的可发现的API。</p>
<p>小结一下：反射并不是只有Java中才有，许多其他的编程语言也都提供了反射功能。</p>
<h3 id="反射该何用"><a href="#反射该何用" class="headerlink" title="反射该何用"></a>反射该何用</h3><p>这里我们先创建一个Person类方便举例</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name; </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">public</span> String test_1;<span class="comment">//测试公有属性1</span></span><br><span class="line">    <span class="keyword">public</span> String test_2;<span class="comment">//测试公有属性2</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age, String email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;测试私有方法能否被访问&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取类的Class实例对象"><a href="#获取类的Class实例对象" class="headerlink" title="获取类的Class实例对象"></a>获取类的Class实例对象</h4><p>该对象是在类加载的时候由JVM自动构造的，有了这个Class实例对象，通过该实例对象我们就可以访问类的成员了。获取Class实例对象的方法有三种，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//直接通过 类.class 获取</span></span><br><span class="line">Class clz_1 = Person.class;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过 Class.forName(&quot;xxx&quot;) 获取，其中xxx指类的路径 注意该方法会抛出ClassNotFoundException异常</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    Class clz_2 = Class.forName(<span class="string">&quot;Person&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (ClassNotFoundException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过 类实例.getClass() 获取</span></span><br><span class="line">Person person = <span class="keyword">new</span> Person();</span><br><span class="line">Class clz_3 = person.getClass();</span><br></pre></td></tr></table></figure>
<h4 id="创建反射类对象"><a href="#创建反射类对象" class="headerlink" title="创建反射类对象"></a>创建反射类对象</h4><p>有两种方法，其中通过构造器创建对象可以实现有参构造。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//先获取Class对象实例</span></span><br><span class="line">Class clz_1 = Person.class;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过Class对象.newInstance()方法只能调用无参构造方法，另外还会抛出异常，这里简单打印异常</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    Person person_1 = (Person) clz_1.newInstance();</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过构造器创建反射类对象</span></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">//可以获得无参构造器</span></span><br><span class="line">    Constructor constructor_1 = clz_1.getConstructor();</span><br><span class="line">    Person person_1 = (Person) constructor_1.newInstance();</span><br><span class="line">    <span class="comment">//可以获得有参构造器</span></span><br><span class="line">    Constructor constructor_2 = clz_1.getConstructor(String.class, <span class="keyword">int</span>.class, String.class);</span><br><span class="line">    Person person_2 = (Person) constructor_2.newInstance(<span class="string">&quot;Tom&quot;</span>, <span class="number">18</span>, <span class="string">&quot;123@qq.com&quot;</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="获取反射对象的属性"><a href="#获取反射对象的属性" class="headerlink" title="获取反射对象的属性"></a>获取反射对象的属性</h4><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>访问方法的个数</th>
<th>访问方法的权限</th>
</tr>
</thead>
<tbody>
<tr>
<td>getField()</td>
<td>1个</td>
<td>public修饰的属性</td>
</tr>
<tr>
<td>getDeclaredField()</td>
<td>1个</td>
<td>全部属性</td>
</tr>
<tr>
<td>getFields()</td>
<td>多个</td>
<td>public修饰的属性</td>
</tr>
<tr>
<td>getDeclaredFields()</td>
<td>多个</td>
<td>全部的属性</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//依旧先获取Class对象实例</span></span><br><span class="line">Class clz_1 = Person.class;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    System.out.print(<span class="string">&quot;getField()获取反射对象的test_1属性类型:&quot;</span>);</span><br><span class="line">    Field field_1 = clz_1.getField(<span class="string">&quot;test_1&quot;</span>);</span><br><span class="line">    System.out.print(field_1.getType());</span><br><span class="line">    System.out.println();</span><br><span class="line"></span><br><span class="line">    System.out.print(<span class="string">&quot;getDeclaredField()获取反射对象的age属性类型:&quot;</span>);</span><br><span class="line">    Field field_2 = clz_1.getDeclaredField(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">    System.out.print(field_2.getType());</span><br><span class="line">    System.out.println();</span><br><span class="line"></span><br><span class="line">    System.out.print(<span class="string">&quot;getFields()获取反射对象的属性:&quot;</span>);</span><br><span class="line">    Field[] field_3 = clz_1.getFields();</span><br><span class="line">    Arrays.asList(field_3).forEach(field -&gt; System.out.print(field.getName() + <span class="string">&quot;, &quot;</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line"></span><br><span class="line">    System.out.print(<span class="string">&quot;getDeclaredFields()获取反射对象的属性:&quot;</span>);</span><br><span class="line">    Field[] field_4 = clz_1.getDeclaredFields();</span><br><span class="line">    Arrays.asList(field_4).forEach(field -&gt; System.out.print(field.getName() + <span class="string">&quot;, &quot;</span>));</span><br><span class="line">    System.out.println();</span><br><span class="line">&#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印结果如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2/images/image-20210524232136202.png"/></p>
<h4 id="获取反射对象的方法"><a href="#获取反射对象的方法" class="headerlink" title="获取反射对象的方法"></a>获取反射对象的方法</h4><div class="table-container">
<table>
<thead>
<tr>
<th></th>
<th>访问方法的个数</th>
<th>访问方法的权限</th>
</tr>
</thead>
<tbody>
<tr>
<td>getMethod()</td>
<td>1个</td>
<td>public修饰的方法，包括父类以及父接口中的public方法</td>
</tr>
<tr>
<td>getDeclaredMethod()</td>
<td>1个</td>
<td>全部的方法，除了遗传方法，即父类中的方法</td>
</tr>
<tr>
<td>getMethods()</td>
<td>多个</td>
<td>public修饰的方法，包括父类以及父接口中的public方法</td>
</tr>
<tr>
<td>getDeclaredMethods()</td>
<td>多个</td>
<td>全部的方法，除了遗传方法，即父类中的方法</td>
</tr>
</tbody>
</table>
</div>
<p>大家可以自行测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;依旧先获取Class对象实例</span><br><span class="line">Class clz_1 &#x3D; Person.class;</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">            System.out.print(&quot;getMethod()获取反射对象的getAge方法返回类型&quot;);</span><br><span class="line">            Method method_1 &#x3D; clz_1.getMethod(&quot;getAge&quot;);</span><br><span class="line">            System.out.print(method_1.getReturnType());</span><br><span class="line">            System.out.println();</span><br><span class="line"></span><br><span class="line">            System.out.print(&quot;getDeclaredMethod()获取反射对象的test方法返回类型：&quot;);</span><br><span class="line">            Method method_2 &#x3D; clz_1.getDeclaredMethod(&quot;test&quot;);</span><br><span class="line">            System.out.print(method_2.getReturnType());</span><br><span class="line">            System.out.println();</span><br><span class="line"></span><br><span class="line">            System.out.print(&quot;getMethods()获取反射对象的方法:&quot;);</span><br><span class="line">            Method[] method_3 &#x3D; clz_1.getMethods();</span><br><span class="line">            Arrays.asList(method_3).forEach(method -&gt; System.out.print(method.getName() + &quot;, &quot;));</span><br><span class="line">            System.out.println();</span><br><span class="line"></span><br><span class="line">            System.out.print(&quot;getDeclaredMethods()获取反射对象的方法:&quot;);</span><br><span class="line">            Method[] method_4 &#x3D; clz_1.getDeclaredMethods();</span><br><span class="line">            Arrays.asList(method_4).forEach(method -&gt; System.out.print(method.getName() + &quot;, &quot;));</span><br><span class="line">            System.out.println();</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>打印结果为：</p>
<p><img src="https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2/images/image-20210524231605222.png"/></p>
<p>可能会有疑问，明明getDeclaredMethods()可以获取到非公有方法，而getMethods()只能获取public方法，这么算起来，前者应该输出更多的方法！但，并不是如此，细看getMethods()输出，有hashCode、getClass方法，这一些方法是Object类中的公共方法，而Object类是所有类的父类，因此，getMethods()也会输出Object类中的方法，除此之外，如果Person类也继承了其他类，也会输出其父类的所有公有方法。</p>
<h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4><p>前面其实有提到在一个类加载的时候，JVM会帮我们生成Class对象并加载到内存中，这相当于提供该类的各种数据的访问接口，而反射实际上就是获取该对象。这也是为什么使用反射之前都要先获取Class对象的原因了。</p>
<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p>在平时的项目开发中，数据库连接、Spring框架都有用到反射；在学习面向对象编程的时候，使用反射也能让我们的代码符合开闭性，即不修改代码的前提下，通过配置文件的方式便可以做到。当然除此之外，还有很多地方也用到了反射。</p>
<p>关于反射的内容就基本上结束了，希望能够帮助大家更好地理解反射，如果其中存在问题请留下你的评论，我会及时修正，另外如果你有其他建议也可以评论留言~</p>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844904005294882830">Java 反射由浅入深</a></p>
<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/tutorial/reflect/index.html">Oracle官方文档</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">月月鸟</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://yueyueniao0223.me/2021/05/25/reflect/">https://yueyueniao0223.me/2021/05/25/reflect/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://yueyueniao0223.me" target="_blank">北冥の鱼</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java%E7%B3%BB%E5%88%97/">Java系列</a><a class="post-meta__tags" href="/tags/%E5%8F%8D%E5%B0%84/">反射</a></div><div class="post_share"><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-600a6b0c81c2e442" async="async"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2021/02/11/leetcode-everyday-2021-02-11/"><img class="next-cover" src="/images/2021-02.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">每日1题[字符串的排序]</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">月月鸟</div><div class="author-info__description">北冥有鱼，化而为鸟</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">6</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">9</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/yueyueniao0223"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/yueyueniao0223" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:yueyueniao0223@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E4%B8%BA%E4%BD%95%E7%89%A9"><span class="toc-number">1.</span> <span class="toc-text">反射为何物</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E6%9C%89%E4%BD%95%E7%94%A8"><span class="toc-number">2.</span> <span class="toc-text">反射有何用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E8%AF%A5%E4%BD%95%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">反射该何用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%B1%BB%E7%9A%84Class%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1"><span class="toc-number">3.1.</span> <span class="toc-text">获取类的Class实例对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%8F%8D%E5%B0%84%E7%B1%BB%E5%AF%B9%E8%B1%A1"><span class="toc-number">3.2.</span> <span class="toc-text">创建反射类对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%8F%8D%E5%B0%84%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="toc-number">3.3.</span> <span class="toc-text">获取反射对象的属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%8F%8D%E5%B0%84%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">3.4.</span> <span class="toc-text">获取反射对象的方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">3.5.</span> <span class="toc-text">原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">4.</span> <span class="toc-text">应用场景</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/05/25/reflect/" title="reflect"><img src="https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2.1/images/image-20210525002237262.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="reflect"/></a><div class="content"><a class="title" href="/2021/05/25/reflect/" title="reflect">reflect</a><time datetime="2021-05-24T16:33:01.000Z" title="发表于 2021-05-25 00:33:01">2021-05-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/11/leetcode-everyday-2021-02-11/" title="每日1题[字符串的排序]"><img src="/images/2021-02.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="每日1题[字符串的排序]"/></a><div class="content"><a class="title" href="/2021/02/11/leetcode-everyday-2021-02-11/" title="每日1题[字符串的排序]">每日1题[字符串的排序]</a><time datetime="2021-02-11T03:43:40.000Z" title="发表于 2021-02-11 11:43:40">2021-02-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/09/leetcode-lcof/" title="剑指offer系列"><img src="https://pic1.zhimg.com/v2-33a4b497dcd468d6d8466bea35430b71_r.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="剑指offer系列"/></a><div class="content"><a class="title" href="/2021/02/09/leetcode-lcof/" title="剑指offer系列">剑指offer系列</a><time datetime="2021-02-09T01:56:08.000Z" title="发表于 2021-02-09 09:56:08">2021-02-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/02/area-cover1/" title="单机区域路径覆盖仿真"><img src="/images/Robot.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="单机区域路径覆盖仿真"/></a><div class="content"><a class="title" href="/2021/02/02/area-cover1/" title="单机区域路径覆盖仿真">单机区域路径覆盖仿真</a><time datetime="2021-02-02T05:31:41.000Z" title="发表于 2021-02-02 13:31:41">2021-02-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/27/searchSkill/" title="搜索技巧"><img src="/images/search.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="搜索技巧"/></a><div class="content"><a class="title" href="/2021/01/27/searchSkill/" title="搜索技巧">搜索技巧</a><time datetime="2021-01-27T12:49:58.000Z" title="发表于 2021-01-27 20:49:58">2021-01-27</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/yueyueniao0223/CDN@1.2.1/images/image-20210525002237262.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By 月月鸟</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="rightside.chat_btn"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.spacingElementById('content-inner')
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'pEDWEB7evzG6a9VDLtKuVF1E-gzGzoHsz',
      appKey: 'R8wpFXvM8DDMGNDrmGK9Mhkf',
      placeholder: '记得留下你的昵称和邮箱^_^ 可以更快收到回复',
      avatar: 'Unicornshawn',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'en',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: {"tv_doge":"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png","tv_親親":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png","tv_再見":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png","tv_發怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png","tv_發財":"34db290afd2963723c6eb3c4560667db7253a21a.png","tv_可愛":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png","tv_嘔吐":"9f996894a39e282ccf5e66856af49483f81870f3.png","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png","tv_壞笑":"1f0b87f731a671079842116e0991c91c2c88645a.png","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png","tv_尷尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png","tv_驚嚇":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png"},
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !true) {
  if (true) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [
  'title',
  '#config_change',
  '#body-wrap',
  '#rightside-config-hide',
  '#rightside-config-show',
  '.js-pjax'
]

if (false) {
  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')
}

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  if (typeof gtag === 'function') {
    gtag('config', '', {'page_path': window.location.pathname});
  }

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // Analytics
  if (false) {
    MtaH5.pgv()
  }

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})


document.addEventListener('pjax:send', function () {
  typeof preloader === 'object' && preloader.initLoading()
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https') {
    bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
    bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>